<!DOCTYPE html>
<html lang="th">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <title>
   üí∞ ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢ Pro
  </title>
  <script src="https://cdn.tailwindcss.com">
  </script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js">
  </script>
  <style>
   @keyframes slideIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    @keyframes bounce {
      0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
      40% { transform: translateY(-10px); }
      60% { transform: translateY(-5px); }
    }
    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    .animate-slideIn { animation: slideIn 0.5s ease-out; }
    .animate-bounce-custom { animation: bounce 1s; }
    .animate-pulse-custom { animation: pulse 2s infinite; }
    .animate-fadeIn { animation: fadeIn 0.3s ease-in; }
    .gradient-bg { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
    .card-hover { transition: all 0.3s ease; }
    .card-hover:hover { transform: translateY(-5px); box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1); }
    .tab-active { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; }
    .tab-inactive { background: #f3f4f6; color: #6b7280; }
  </style>
 </head>
 <body class="from-purple-100 via-pink-50 to-blue-100 min-h-screen bg-white min-h-screen">
  <!-- Navigation -->
  <nav class="gradient-bg shadow-lg sticky top-0 z-50">
   <div class="max-w-7xl mx-auto px-4 py-4">
    <div class="flex items-center justify-between">
     <div class="flex items-center space-x-3">
      <div class="text-3xl animate-bounce-custom">
       üí∞
      </div>
      <h1 class="text-2xl font-bold text-white">
       ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢ Pro
      </h1>
     </div>
     <div class="flex space-x-2">
      <button class="tab-active px-4 py-2 rounded-lg transition duration-200 font-medium" id="tabDashboard">
       üìä ‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î
      </button>
      <button class="tab-inactive px-4 py-2 rounded-lg transition duration-200 font-medium" id="tabRecurring">
       üîÑ ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏à‡∏≥
      </button>
      <button class="tab-inactive px-4 py-2 rounded-lg transition duration-200 font-medium" id="tabHistory">
       üìÖ ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥
      </button>
      <button class="tab-inactive px-4 py-2 rounded-lg transition duration-200 font-medium" id="tabConfig">
       ‚öôÔ∏è ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤
      </button>
     </div>
    </div>
   </div>
  </nav>
  <!-- Dashboard Tab -->
  <div class="max-w-7xl mx-auto py-8 px-4" id="dashboardContent">
   <!-- Month/Year Selector -->
   <div class="bg-white rounded-2xl shadow-xl p-6 mb-8 card-hover animate-slideIn">
    <div class="flex items-center justify-between">
     <h2 class="text-xl font-bold text-gray-800">
      üìÖ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤
     </h2>
     <div class="flex space-x-4">
      <select class="border-2 border-gray-200 px-4 py-2 rounded-xl focus:ring-2 focus:ring-purple-500" id="monthSelector">
       <option value="">
        ‡∏ó‡∏∏‡∏Å‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
       </option>
       <option value="01">
        ‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°
       </option>
       <option value="02">
        ‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå
       </option>
       <option value="03">
        ‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°
       </option>
       <option value="04">
        ‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô
       </option>
       <option value="05">
        ‡∏û‡∏§‡∏©‡∏†‡∏≤‡∏Ñ‡∏°
       </option>
       <option value="06">
        ‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô
       </option>
       <option value="07">
        ‡∏Å‡∏£‡∏Å‡∏é‡∏≤‡∏Ñ‡∏°
       </option>
       <option value="08">
        ‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏°
       </option>
       <option value="09">
        ‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô
       </option>
       <option value="10">
        ‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°
       </option>
       <option value="11">
        ‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô
       </option>
       <option value="12">
        ‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°
       </option>
      </select>
      <select class="border-2 border-gray-200 px-4 py-2 rounded-xl focus:ring-2 focus:ring-purple-500" id="yearSelector">
      </select>
     </div>
    </div>
   </div>
   <!-- Quick Stats Dashboard -->
   <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
    <div class="bg-gradient-to-r from-green-400 to-green-600 rounded-2xl shadow-xl p-6 text-white card-hover animate-slideIn">
     <div class="flex items-center justify-between">
      <div>
       <p class="text-green-100 text-sm">
        ‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
       </p>
       <p class="text-3xl font-bold" id="totalIncome">
        ‡∏ø0.00
       </p>
      </div>
      <div class="text-4xl animate-pulse-custom">
       üíµ
      </div>
     </div>
    </div>
    <div class="bg-gradient-to-r from-red-400 to-red-600 rounded-2xl shadow-xl p-6 text-white card-hover animate-slideIn" style="animation-delay: 0.1s">
     <div class="flex items-center justify-between">
      <div>
       <p class="text-red-100 text-sm">
        ‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
       </p>
       <p class="text-3xl font-bold" id="totalExpense">
        ‡∏ø0.00
       </p>
      </div>
      <div class="text-4xl animate-pulse-custom">
       üí∏
      </div>
     </div>
    </div>
    <div class="bg-gradient-to-r from-blue-400 to-blue-600 rounded-2xl shadow-xl p-6 text-white card-hover animate-slideIn" style="animation-delay: 0.2s">
     <div class="flex items-center justify-between">
      <div>
       <p class="text-blue-100 text-sm">
        ‡∏¢‡∏≠‡∏î‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠
       </p>
       <p class="text-3xl font-bold" id="balance">
        ‡∏ø0.00
       </p>
      </div>
      <div class="text-4xl animate-pulse-custom">
       üí∞
      </div>
     </div>
    </div>
    <div class="bg-gradient-to-r from-purple-400 to-purple-600 rounded-2xl shadow-xl p-6 text-white card-hover animate-slideIn" style="animation-delay: 0.3s">
     <div class="flex items-center justify-between">
      <div>
       <p class="text-purple-100 text-sm">
        ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
       </p>
       <p class="text-3xl font-bold" id="totalTransactions">
        0
       </p>
      </div>
      <div class="text-4xl animate-pulse-custom">
       üìä
      </div>
     </div>
    </div>
   </div>
   <!-- Main Content Grid -->
   <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
    <!-- Left Column: Form -->
    <div class="lg:col-span-1 space-y-6">
     <!-- Add Transaction Form -->
     <div class="bg-white rounded-2xl shadow-xl p-6 card-hover animate-slideIn">
      <div class="flex items-center space-x-3 mb-6">
       <div class="text-2xl">
        ‚ûï
       </div>
       <h2 class="text-xl font-bold text-gray-800">
        ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà
       </h2>
      </div>
      <form class="space-y-4" id="expenseForm">
       <div>
        <label class="block text-sm font-medium text-gray-700 mb-2">
         ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó
        </label>
        <select class="w-full border-2 border-gray-200 px-4 py-3 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition duration-200" id="type">
         <option value="‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö">
          üíµ ‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö
         </option>
         <option value="‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢">
          üí∏ ‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢
         </option>
        </select>
       </div>
       <div>
        <label class="block text-sm font-medium text-gray-700 mb-2">
         ‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà
        </label>
        <select class="w-full border-2 border-gray-200 px-4 py-3 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition duration-200" id="category">
        </select>
       </div>
       <div>
        <label class="block text-sm font-medium text-gray-700 mb-2">
         ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô (‡∏ö‡∏≤‡∏ó)
        </label>
        <input class="w-full border-2 border-gray-200 px-4 py-3 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition duration-200" id="amount" min="0" required="" step="0.01" type="number"/>
       </div>
       <div>
        <label class="block text-sm font-medium text-gray-700 mb-2">
         ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏
        </label>
        <input class="w-full border-2 border-gray-200 px-4 py-3 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition duration-200" id="note" placeholder="‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°..." type="text"/>
       </div>
       <div>
        <label class="block text-sm font-medium text-gray-700 mb-2">
         ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà
        </label>
        <input class="w-full border-2 border-gray-200 px-4 py-3 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition duration-200" id="date" required="" type="date"/>
       </div>
       <button class="w-full bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white px-6 py-4 rounded-xl font-bold text-lg transition duration-200 transform hover:scale-105" type="submit">
        ‚ú® ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
       </button>
      </form>
      <div class="mt-4 p-4 bg-green-100 text-green-700 rounded-xl font-medium hidden animate-fadeIn" id="message">
       ‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!
      </div>
     </div>
    </div>
    <!-- Right Column: Charts and Transactions -->
    <div class="lg:col-span-2 space-y-6">
     <!-- Charts Section -->
     <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <!-- Income Pie Chart -->
      <div class="bg-white rounded-2xl shadow-xl p-6 card-hover animate-slideIn">
       <h3 class="text-lg font-bold text-gray-800 mb-4">
        üíµ ‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö
       </h3>
       <canvas height="300" id="incomeChart" width="300">
       </canvas>
      </div>
      <!-- Expense Pie Chart -->
      <div class="bg-white rounded-2xl shadow-xl p-6 card-hover animate-slideIn">
       <h3 class="text-lg font-bold text-gray-800 mb-4">
        üí∏ ‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢
       </h3>
       <canvas height="300" id="expenseChart" width="300">
       </canvas>
      </div>
     </div>
     <!-- Transactions List -->
     <div class="bg-white rounded-2xl shadow-xl p-6 card-hover animate-slideIn">
      <div class="flex items-center justify-between mb-6">
       <h3 class="text-lg font-bold text-gray-800">
        üìã ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
       </h3>
       <div class="flex space-x-2">
        <input class="border-2 border-gray-200 px-3 py-1 rounded-lg text-sm" id="searchInput" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤..." type="text"/>
       </div>
      </div>
      <div class="space-y-3 max-h-96 overflow-y-auto" id="transactionsList">
       <div class="text-center text-gray-500 py-8">
        üìù ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏£‡∏Å‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢!
       </div>
      </div>
     </div>
    </div>
   </div>
  </div>
  <!-- Recurring Tab -->
  <div class="max-w-7xl mx-auto py-8 px-4 hidden" id="recurringContent">
   <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
    <!-- Add Recurring Transaction -->
    <div class="bg-white rounded-2xl shadow-xl p-6 card-hover">
     <h2 class="text-xl font-bold text-gray-800 mb-6">
      üîÑ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
     </h2>
     <form class="space-y-4" id="recurringForm">
      <div>
       <label class="block text-sm font-medium text-gray-700 mb-2">
        ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó
       </label>
       <select class="w-full border-2 border-gray-200 px-4 py-3 rounded-xl focus:ring-2 focus:ring-purple-500" id="recurringType">
        <option value="‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö">
         üíµ ‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö
        </option>
        <option value="‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢">
         üí∏ ‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢
        </option>
       </select>
      </div>
      <div>
       <label class="block text-sm font-medium text-gray-700 mb-2">
        ‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà
       </label>
       <select class="w-full border-2 border-gray-200 px-4 py-3 rounded-xl focus:ring-2 focus:ring-purple-500" id="recurringCategory">
       </select>
      </div>
      <div>
       <label class="block text-sm font-medium text-gray-700 mb-2">
        ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô (‡∏ö‡∏≤‡∏ó)
       </label>
       <input class="w-full border-2 border-gray-200 px-4 py-3 rounded-xl focus:ring-2 focus:ring-purple-500" id="recurringAmount" min="0" required="" step="0.01" type="number"/>
      </div>
      <div>
       <label class="block text-sm font-medium text-gray-700 mb-2">
        ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏
       </label>
       <input class="w-full border-2 border-gray-200 px-4 py-3 rounded-xl focus:ring-2 focus:ring-purple-500" id="recurringNote" placeholder="‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î..." type="text"/>
      </div>
      <div>
       <label class="block text-sm font-medium text-gray-700 mb-2">
        ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
       </label>
       <select class="w-full border-2 border-gray-200 px-4 py-3 rounded-xl focus:ring-2 focus:ring-purple-500" id="recurringDay">
        <option value="1">
         ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 1
        </option>
        <option value="5">
         ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 5
        </option>
        <option value="10">
         ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 10
        </option>
        <option value="15">
         ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 15
        </option>
        <option value="20">
         ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 20
        </option>
        <option value="25">
         ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 25
        </option>
        <option value="30">
         ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 30
        </option>
       </select>
      </div>
      <button class="w-full bg-gradient-to-r from-blue-500 to-purple-500 hover:from-blue-600 hover:to-purple-600 text-white px-6 py-4 rounded-xl font-bold transition duration-200" type="submit">
       üîÑ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏à‡∏≥
      </button>
     </form>
    </div>
    <!-- Recurring Transactions List -->
    <div class="bg-white rounded-2xl shadow-xl p-6 card-hover">
     <h3 class="text-lg font-bold text-gray-800 mb-6">
      üìã ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
     </h3>
     <div class="space-y-3" id="recurringList">
      <div class="text-center text-gray-500 py-8">
       üîÑ ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏à‡∏≥
      </div>
     </div>
    </div>
   </div>
  </div>
  <!-- History Tab -->
  <div class="max-w-7xl mx-auto py-8 px-4 hidden" id="historyContent">
   <!-- Year Summary -->
   <div class="bg-white rounded-2xl shadow-xl p-6 mb-8 card-hover">
    <div class="flex items-center justify-between mb-6">
     <h2 class="text-xl font-bold text-gray-800">
      üìä ‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡∏õ‡∏µ
     </h2>
     <select class="border-2 border-gray-200 px-4 py-2 rounded-xl focus:ring-2 focus:ring-purple-500" id="yearSummarySelector">
     </select>
    </div>
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
     <div class="text-center">
      <div class="text-3xl mb-2">
       üíµ
      </div>
      <div class="text-sm text-gray-600">
       ‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏£‡∏ß‡∏°
      </div>
      <div class="text-2xl font-bold text-green-600" id="yearlyIncome">
       ‡∏ø0.00
      </div>
     </div>
     <div class="text-center">
      <div class="text-3xl mb-2">
       üí∏
      </div>
      <div class="text-sm text-gray-600">
       ‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡∏£‡∏ß‡∏°
      </div>
      <div class="text-2xl font-bold text-red-600" id="yearlyExpense">
       ‡∏ø0.00
      </div>
     </div>
     <div class="text-center">
      <div class="text-3xl mb-2">
       üí∞
      </div>
      <div class="text-sm text-gray-600">
       ‡∏¢‡∏≠‡∏î‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠
      </div>
      <div class="text-2xl font-bold text-blue-600" id="yearlyBalance">
       ‡∏ø0.00
      </div>
     </div>
    </div>
   </div>
   <!-- Monthly Breakdown -->
   <div class="bg-white rounded-2xl shadow-xl p-6 card-hover">
    <h3 class="text-lg font-bold text-gray-800 mb-6">
     üìÖ ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
    </h3>
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4" id="monthlyBreakdown">
    </div>
   </div>
  </div>
  <!-- Config Tab -->
  <div class="max-w-7xl mx-auto py-8 px-4 hidden" id="configContent">
   <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
    <!-- Income Categories -->
    <div class="bg-white rounded-2xl shadow-xl p-6 card-hover">
     <h2 class="text-xl font-bold text-gray-800 mb-6">
      üíµ ‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö
     </h2>
     <div class="mb-4">
      <div class="flex space-x-2">
       <input class="flex-1 border-2 border-gray-200 px-4 py-2 rounded-xl focus:ring-2 focus:ring-purple-500" id="newIncomeCategory" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡πÉ‡∏´‡∏°‡πà..." type="text"/>
       <input class="w-16 border-2 border-gray-200 px-2 py-2 rounded-xl text-center focus:ring-2 focus:ring-purple-500" id="newIncomeCategoryIcon" maxlength="2" placeholder="üè¢" type="text"/>
       <button class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-xl transition duration-200" id="addIncomeCategory">
        ‡πÄ‡∏û‡∏¥‡πà‡∏°
       </button>
      </div>
     </div>
     <div class="space-y-2" id="incomeCategoriesList">
     </div>
    </div>
    <!-- Expense Categories -->
    <div class="bg-white rounded-2xl shadow-xl p-6 card-hover">
     <h2 class="text-xl font-bold text-gray-800 mb-6">
      üí∏ ‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢
     </h2>
     <div class="mb-4">
      <div class="flex space-x-2">
       <input class="flex-1 border-2 border-gray-200 px-4 py-2 rounded-xl focus:ring-2 focus:ring-purple-500" id="newExpenseCategory" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡πÉ‡∏´‡∏°‡πà..." type="text"/>
       <input class="w-16 border-2 border-gray-200 px-2 py-2 rounded-xl text-center focus:ring-2 focus:ring-purple-500" id="newExpenseCategoryIcon" maxlength="2" placeholder="üçΩÔ∏è" type="text"/>
       <button class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-xl transition duration-200" id="addExpenseCategory">
        ‡πÄ‡∏û‡∏¥‡πà‡∏°
       </button>
      </div>
     </div>
     <div class="space-y-2" id="expenseCategoriesList">
     </div>
    </div>
   </div>
   <!-- Data Management -->
   <div class="bg-white rounded-2xl shadow-xl p-6 mt-8 card-hover">
    <h2 class="text-xl font-bold text-gray-800 mb-6">
     üóÇÔ∏è ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
    </h2>
    <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
     <button class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-3 rounded-xl transition duration-200" id="exportData">
      üìä ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
     </button>
     <button class="bg-green-500 hover:bg-green-600 text-white px-4 py-3 rounded-xl transition duration-200" id="backupData">
      üíæ ‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
     </button>
     <button class="bg-yellow-500 hover:bg-yellow-600 text-white px-4 py-3 rounded-xl transition duration-200" id="resetCategories">
      üîÑ ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà
     </button>
     <button class="bg-red-500 hover:bg-red-600 text-white px-4 py-3 rounded-xl transition duration-200" id="clearAllData">
      üóëÔ∏è ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
     </button>
    </div>
   </div>
  </div>
  <!-- Edit Modal -->
  <div class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50" id="editModal">
   <div class="bg-white rounded-2xl p-6 m-4 w-full max-w-md animate-slideIn">
    <h3 class="text-xl font-bold mb-4">
     ‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£
    </h3>
    <form class="space-y-4" id="editForm">
     <input id="editId" type="hidden"/>
     <div>
      <label class="block text-sm font-medium text-gray-700 mb-2">
       ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó
      </label>
      <select class="w-full border-2 border-gray-200 px-4 py-3 rounded-xl" id="editType">
       <option value="‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö">
        üíµ ‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö
       </option>
       <option value="‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢">
        üí∏ ‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢
       </option>
      </select>
     </div>
     <div>
      <label class="block text-sm font-medium text-gray-700 mb-2">
       ‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà
      </label>
      <select class="w-full border-2 border-gray-200 px-4 py-3 rounded-xl" id="editCategory">
      </select>
     </div>
     <div>
      <label class="block text-sm font-medium text-gray-700 mb-2">
       ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô
      </label>
      <input class="w-full border-2 border-gray-200 px-4 py-3 rounded-xl" id="editAmount" required="" step="0.01" type="number"/>
     </div>
     <div>
      <label class="block text-sm font-medium text-gray-700 mb-2">
       ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏
      </label>
      <input class="w-full border-2 border-gray-200 px-4 py-3 rounded-xl" id="editNote" type="text"/>
     </div>
     <div>
      <label class="block text-sm font-medium text-gray-700 mb-2">
       ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà
      </label>
      <input class="w-full border-2 border-gray-200 px-4 py-3 rounded-xl" id="editDate" required="" type="date"/>
     </div>
     <div class="flex space-x-3">
      <button class="flex-1 bg-blue-500 hover:bg-blue-600 text-white py-3 rounded-xl" type="submit">
       ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
      </button>
      <button class="flex-1 bg-gray-300 hover:bg-gray-400 text-gray-700 py-3 rounded-xl" id="closeEdit" type="button">
       ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
      </button>
     </div>
    </form>
   </div>
  </div>
  <script type="module">
   // Firebase configuration and imports
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getDatabase, ref, push, set, onValue, query, orderByChild, limitToLast, remove, update } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js";

    const firebaseConfig = {
      apiKey: "AIzaSyCDAaW-OyL_13qkF7sCxXkMhpJyrOtntjg",
      authDomain: "orders-3d979.firebaseapp.com",
      databaseURL: "https://orders-3d979-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "orders-3d979",
      storageBucket: "orders-3d979.appspot.com",
      messagingSenderId: "123456789",
      appId: "1:123456789:web:4f1b772b853b602cc93e94",
      measurementId: "G-P5JPR90CX8"
    };

    const app = initializeApp(firebaseConfig);
    const database = getDatabase(app);

    // Global variables
    let allTransactions = [];
    let filteredTransactions = [];
    let recurringTransactions = [];
    let incomeCategories = [];
    let expenseCategories = [];
    let incomeChart, expenseChart;
    let currentTab = 'dashboard';

    // Default categories
    const defaultIncomeCategories = [
      { name: '‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô', icon: 'üíº' },
      { name: '‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à', icon: 'üí∞' },
      { name: '‡∏•‡∏á‡∏ó‡∏∏‡∏ô', icon: 'üìà' },
      { name: '‡∏≠‡∏∑‡πà‡∏ô‡πÜ', icon: 'üíµ' }
    ];

    const defaultExpenseCategories = [
      { name: '‡∏≠‡∏≤‡∏´‡∏≤‡∏£', icon: 'üçΩÔ∏è' },
      { name: '‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á', icon: 'üöó' },
      { name: '‡∏ä‡πâ‡∏≠‡∏õ‡∏õ‡∏¥‡πâ‡∏á', icon: 'üõçÔ∏è' },
      { name: '‡∏ö‡∏¥‡∏•', icon: 'üí°' },
      { name: '‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û', icon: 'üè•' },
      { name: '‡∏ö‡∏±‡∏ô‡πÄ‡∏ó‡∏¥‡∏á', icon: 'üé¨' },
      { name: '‡∏≠‡∏∑‡πà‡∏ô‡πÜ', icon: 'üí∏' }
    ];

    // DOM elements
    const form = document.getElementById('expenseForm');
    const message = document.getElementById('message');

    // Initialize
    function init() {
      setupTabs();
      setupYearSelectors();
      loadCategories();
      loadTransactions();
      loadRecurringTransactions();
      setupEventListeners();
      document.getElementById('date').valueAsDate = new Date();
    }

    // Setup tabs
    function setupTabs() {
      const tabs = ['Dashboard', 'Recurring', 'History', 'Config'];
      tabs.forEach(tab => {
        document.getElementById(`tab${tab}`).addEventListener('click', () => switchTab(tab.toLowerCase()));
      });
    }

    // Switch tab
    function switchTab(tab) {
      // Hide all content
      document.querySelectorAll('[id$="Content"]').forEach(el => el.classList.add('hidden'));
      
      // Show selected content
      document.getElementById(`${tab}Content`).classList.remove('hidden');
      
      // Update tab buttons
      document.querySelectorAll('[id^="tab"]').forEach(el => {
        el.className = 'tab-inactive px-4 py-2 rounded-lg transition duration-200 font-medium';
      });
      document.getElementById(`tab${tab.charAt(0).toUpperCase() + tab.slice(1)}`).className = 'tab-active px-4 py-2 rounded-lg transition duration-200 font-medium';
      
      currentTab = tab;
      
      if (tab === 'history') {
        updateYearSummary();
      }
    }

    // Setup year selectors
    function setupYearSelectors() {
      const currentYear = new Date().getFullYear();
      const years = [];
      for (let i = currentYear; i >= currentYear - 10; i--) {
        years.push(i);
      }
      
      const yearSelector = document.getElementById('yearSelector');
      const yearSummarySelector = document.getElementById('yearSummarySelector');
      
      years.forEach(year => {
        const option1 = new Option(year, year);
        const option2 = new Option(year, year);
        yearSelector.add(option1);
        yearSummarySelector.add(option2);
      });
      
      yearSelector.value = currentYear;
      yearSummarySelector.value = currentYear;
      
      // Set current month
      const currentMonth = String(new Date().getMonth() + 1).padStart(2, '0');
      document.getElementById('monthSelector').value = currentMonth;
    }

    // Load categories
    function loadCategories() {
      const incomeCategoriesRef = ref(database, 'categories/income');
      const expenseCategoriesRef = ref(database, 'categories/expense');
      
      onValue(incomeCategoriesRef, (snapshot) => {
        if (snapshot.exists()) {
          incomeCategories = Object.entries(snapshot.val()).map(([key, value]) => ({ id: key, ...value }));
        } else {
          incomeCategories = defaultIncomeCategories.map((cat, index) => ({ id: index, ...cat }));
          // Save default categories
          defaultIncomeCategories.forEach((cat, index) => {
            set(ref(database, `categories/income/${index}`), cat);
          });
        }
        updateCategorySelectors();
        updateCategoriesConfig();
      });
      
      onValue(expenseCategoriesRef, (snapshot) => {
        if (snapshot.exists()) {
          expenseCategories = Object.entries(snapshot.val()).map(([key, value]) => ({ id: key, ...value }));
        } else {
          expenseCategories = defaultExpenseCategories.map((cat, index) => ({ id: index, ...cat }));
          // Save default categories
          defaultExpenseCategories.forEach((cat, index) => {
            set(ref(database, `categories/expense/${index}`), cat);
          });
        }
        updateCategorySelectors();
        updateCategoriesConfig();
      });
    }

    // Update category selectors
    function updateCategorySelectors() {
      const selectors = ['category', 'recurringCategory', 'editCategory'];
      
      selectors.forEach(selectorId => {
        const selector = document.getElementById(selectorId);
        const currentType = selectorId === 'category' ? document.getElementById('type').value :
                           selectorId === 'recurringCategory' ? document.getElementById('recurringType').value :
                           document.getElementById('editType').value;
        
        selector.innerHTML = '';
        const categories = currentType === '‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö' ? incomeCategories : expenseCategories;
        
        categories.forEach(cat => {
          const option = new Option(`${cat.icon} ${cat.name}`, cat.name);
          selector.add(option);
        });
      });
    }

    // Update categories config
    function updateCategoriesConfig() {
      updateCategoryConfigList('income', incomeCategories);
      updateCategoryConfigList('expense', expenseCategories);
    }

    // Update category config list
    function updateCategoryConfigList(type, categories) {
      const listEl = document.getElementById(`${type}CategoriesList`);
      listEl.innerHTML = categories.map(cat => `
        <div class="flex items-center justify-between p-3 border border-gray-200 rounded-lg">
          <div class="flex items-center space-x-3">
            <span class="text-xl">${cat.icon}</span>
            <span class="font-medium">${cat.name}</span>
          </div>
          <button onclick="deleteCategory('${type}', '${cat.id}')" class="text-red-500 hover:text-red-700 text-sm">
            üóëÔ∏è ‡∏•‡∏ö
          </button>
        </div>
      `).join('');
    }

    // Format currency
    function formatCurrency(amount) {
      return new Intl.NumberFormat('th-TH', {
        style: 'currency',
        currency: 'THB'
      }).format(amount);
    }

    // Format date
    function formatDate(dateString) {
      const date = new Date(dateString);
      return date.toLocaleDateString('th-TH', {
        year: 'numeric',
        month: 'short',
        day: 'numeric'
      });
    }

    // Get category icon
    function getCategoryIcon(categoryName, type) {
      const categories = type === '‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö' ? incomeCategories : expenseCategories;
      const category = categories.find(cat => cat.name === categoryName);
      return category ? category.icon : (type === '‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö' ? 'üíµ' : 'üí∏');
    }

    // Filter transactions by date
    function filterTransactionsByDate() {
      const selectedMonth = document.getElementById('monthSelector').value;
      const selectedYear = document.getElementById('yearSelector').value;
      const searchTerm = document.getElementById('searchInput').value.toLowerCase();
      
      filteredTransactions = allTransactions.filter(({ data }) => {
        const transactionDate = new Date(data.date);
        const transactionYear = transactionDate.getFullYear().toString();
        const transactionMonth = String(transactionDate.getMonth() + 1).padStart(2, '0');
        
        const matchesYear = !selectedYear || transactionYear === selectedYear;
        const matchesMonth = !selectedMonth || transactionMonth === selectedMonth;
        const matchesSearch = !searchTerm || 
          data.note.toLowerCase().includes(searchTerm) ||
          data.category.toLowerCase().includes(searchTerm);
        
        return matchesYear && matchesMonth && matchesSearch;
      });
      
      updateSummary();
      updateCharts();
      displayTransactions();
    }

    // Update summary
    function updateSummary() {
      const totalIncome = filteredTransactions
        .filter(t => t.data.type === '‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö')
        .reduce((sum, t) => sum + t.data.amount, 0);
      
      const totalExpense = filteredTransactions
        .filter(t => t.data.type === '‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢')
        .reduce((sum, t) => sum + t.data.amount, 0);
      
      const balance = totalIncome - totalExpense;
      
      document.getElementById('totalIncome').textContent = formatCurrency(totalIncome);
      document.getElementById('totalExpense').textContent = formatCurrency(totalExpense);
      document.getElementById('balance').textContent = formatCurrency(balance);
      document.getElementById('totalTransactions').textContent = filteredTransactions.length.toLocaleString();
    }

    // Update charts
    function updateCharts() {
      updateIncomeChart();
      updateExpenseChart();
    }

    // Update income chart
    function updateIncomeChart() {
      const ctx = document.getElementById('incomeChart').getContext('2d');
      
      const incomeByCategory = {};
      filteredTransactions
        .filter(t => t.data.type === '‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö')
        .forEach(t => {
          const category = t.data.category || '‡∏≠‡∏∑‡πà‡∏ô‡πÜ';
          incomeByCategory[category] = (incomeByCategory[category] || 0) + t.data.amount;
        });

      const labels = Object.keys(incomeByCategory);
      const data = Object.values(incomeByCategory);
      const colors = ['#10B981', '#059669', '#047857', '#065F46', '#064E3B'];

      if (incomeChart) incomeChart.destroy();
      
      if (labels.length === 0) {
        ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);
        ctx.font = '16px Arial';
        ctx.fillStyle = '#9CA3AF';
        ctx.textAlign = 'center';
        ctx.fillText('‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö', ctx.canvas.width / 2, ctx.canvas.height / 2);
        return;
      }
      
      incomeChart = new Chart(ctx, {
        type: 'doughnut',
        data: {
          labels: labels,
          datasets: [{
            data: data,
            backgroundColor: colors.slice(0, labels.length),
            borderWidth: 2,
            borderColor: '#fff'
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              position: 'bottom',
              labels: {
                padding: 15,
                usePointStyle: true,
                font: { size: 12 }
              }
            }
          }
        }
      });
    }

    // Update expense chart
    function updateExpenseChart() {
      const ctx = document.getElementById('expenseChart').getContext('2d');
      
      const expensesByCategory = {};
      filteredTransactions
        .filter(t => t.data.type === '‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢')
        .forEach(t => {
          const category = t.data.category || '‡∏≠‡∏∑‡πà‡∏ô‡πÜ';
          expensesByCategory[category] = (expensesByCategory[category] || 0) + t.data.amount;
        });

      const labels = Object.keys(expensesByCategory);
      const data = Object.values(expensesByCategory);
      const colors = ['#EF4444', '#DC2626', '#B91C1C', '#991B1B', '#7F1D1D'];

      if (expenseChart) expenseChart.destroy();
      
      if (labels.length === 0) {
        ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);
        ctx.font = '16px Arial';
        ctx.fillStyle = '#9CA3AF';
        ctx.textAlign = 'center';
        ctx.fillText('‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢', ctx.canvas.width / 2, ctx.canvas.height / 2);
        return;
      }
      
      expenseChart = new Chart(ctx, {
        type: 'doughnut',
        data: {
          labels: labels,
          datasets: [{
            data: data,
            backgroundColor: colors.slice(0, labels.length),
            borderWidth: 2,
            borderColor: '#fff'
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              position: 'bottom',
              labels: {
                padding: 15,
                usePointStyle: true,
                font: { size: 12 }
              }
            }
          }
        }
      });
    }

    // Display transactions
    function displayTransactions() {
      const transactionsListEl = document.getElementById('transactionsList');
      
      if (filteredTransactions.length === 0) {
        transactionsListEl.innerHTML = `
          <div class="text-center text-gray-500 py-8">
            üìù ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
          </div>
        `;
        return;
      }

      transactionsListEl.innerHTML = filteredTransactions
        .slice(0, 50) // Show only first 50 transactions
        .map(({ key, data }) => {
          const isIncome = data.type === '‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö';
          const icon = getCategoryIcon(data.category, data.type);
          const amountClass = isIncome ? 'text-green-600' : 'text-red-600';
          const bgClass = isIncome ? 'bg-green-50 border-green-200' : 'bg-red-50 border-red-200';
          const sign = isIncome ? '+' : '-';
          
          return `
            <div class="flex items-center justify-between p-4 border-2 ${bgClass} rounded-xl hover:shadow-md transition duration-200 animate-fadeIn">
              <div class="flex items-center space-x-4">
                <div class="text-2xl">${icon}</div>
                <div>
                  <div class="font-bold text-gray-800">${data.note || data.category}</div>
                  <div class="text-sm text-gray-500">${formatDate(data.date)} ‚Ä¢ ${data.category}</div>
                </div>
              </div>
              <div class="text-right">
                <div class="font-bold text-lg ${amountClass}">${sign}${formatCurrency(Math.abs(data.amount))}</div>
                <div class="flex space-x-2 mt-1">
                  <button onclick="editTransaction('${key}')" class="text-xs text-blue-500 hover:text-blue-700">‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>
                  <button onclick="deleteTransaction('${key}')" class="text-xs text-red-500 hover:text-red-700">üóëÔ∏è ‡∏•‡∏ö</button>
                </div>
              </div>
            </div>
          `;
        })
        .join('');
    }

    // Load transactions
    function loadTransactions() {
      const expensesRef = ref(database, 'expenses');
      
      onValue(expensesRef, (snapshot) => {
        allTransactions = [];
        
        snapshot.forEach((childSnapshot) => {
          const data = childSnapshot.val();
          const key = childSnapshot.key;
          allTransactions.push({ key, data });
        });
        
        // Sort by date (newest first)
        allTransactions.sort((a, b) => new Date(b.data.date) - new Date(a.data.date));
        
        filterTransactionsByDate();
      });
    }

    // Load recurring transactions
    function loadRecurringTransactions() {
      const recurringRef = ref(database, 'recurring');
      
      onValue(recurringRef, (snapshot) => {
        recurringTransactions = [];
        
        snapshot.forEach((childSnapshot) => {
          const data = childSnapshot.val();
          const key = childSnapshot.key;
          recurringTransactions.push({ key, data });
        });
        
        displayRecurringTransactions();
      });
    }

    // Display recurring transactions
    function displayRecurringTransactions() {
      const recurringListEl = document.getElementById('recurringList');
      
      if (recurringTransactions.length === 0) {
        recurringListEl.innerHTML = `
          <div class="text-center text-gray-500 py-8">
            üîÑ ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏à‡∏≥
          </div>
        `;
        return;
      }

      recurringListEl.innerHTML = recurringTransactions.map(({ key, data }) => {
        const isIncome = data.type === '‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö';
        const icon = getCategoryIcon(data.category, data.type);
        const amountClass = isIncome ? 'text-green-600' : 'text-red-600';
        const bgClass = isIncome ? 'bg-green-50 border-green-200' : 'bg-red-50 border-red-200';
        const sign = isIncome ? '+' : '-';
        
        return `
          <div class="flex items-center justify-between p-4 border-2 ${bgClass} rounded-xl">
            <div class="flex items-center space-x-4">
              <div class="text-2xl">${icon}</div>
              <div>
                <div class="font-bold text-gray-800">${data.note || data.category}</div>
                <div class="text-sm text-gray-500">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà ${data.day} ‡∏Ç‡∏≠‡∏á‡∏ó‡∏∏‡∏Å‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‚Ä¢ ${data.category}</div>
              </div>
            </div>
            <div class="text-right">
              <div class="font-bold text-lg ${amountClass}">${sign}${formatCurrency(Math.abs(data.amount))}</div>
              <div class="flex space-x-2 mt-1">
                <button onclick="processRecurring('${key}')" class="text-xs text-green-500 hover:text-green-700">‚ñ∂Ô∏è ‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</button>
                <button onclick="deleteRecurring('${key}')" class="text-xs text-red-500 hover:text-red-700">üóëÔ∏è ‡∏•‡∏ö</button>
              </div>
            </div>
          </div>
        `;
      }).join('');
    }

    // Update year summary
    function updateYearSummary() {
      const selectedYear = document.getElementById('yearSummarySelector').value;
      
      const yearTransactions = allTransactions.filter(({ data }) => {
        return new Date(data.date).getFullYear().toString() === selectedYear;
      });
      
      const yearlyIncome = yearTransactions
        .filter(t => t.data.type === '‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö')
        .reduce((sum, t) => sum + t.data.amount, 0);
      
      const yearlyExpense = yearTransactions
        .filter(t => t.data.type === '‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢')
        .reduce((sum, t) => sum + t.data.amount, 0);
      
      const yearlyBalance = yearlyIncome - yearlyExpense;
      
      document.getElementById('yearlyIncome').textContent = formatCurrency(yearlyIncome);
      document.getElementById('yearlyExpense').textContent = formatCurrency(yearlyExpense);
      document.getElementById('yearlyBalance').textContent = formatCurrency(yearlyBalance);
      
      // Update monthly breakdown
      updateMonthlyBreakdown(yearTransactions);
    }

    // Update monthly breakdown
    function updateMonthlyBreakdown(yearTransactions) {
      const monthlyData = {};
      const months = ['‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°', '‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå', '‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°', '‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô', '‡∏û‡∏§‡∏©‡∏†‡∏≤‡∏Ñ‡∏°', '‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô',
                     '‡∏Å‡∏£‡∏Å‡∏é‡∏≤‡∏Ñ‡∏°', '‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏°', '‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô', '‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°', '‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô', '‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°'];
      
      // Initialize monthly data
      for (let i = 0; i < 12; i++) {
        monthlyData[i] = { income: 0, expense: 0, month: months[i] };
      }
      
      // Calculate monthly totals
      yearTransactions.forEach(({ data }) => {
        const month = new Date(data.date).getMonth();
        if (data.type === '‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö') {
          monthlyData[month].income += data.amount;
        } else {
          monthlyData[month].expense += data.amount;
        }
      });
      
      const monthlyBreakdownEl = document.getElementById('monthlyBreakdown');
      monthlyBreakdownEl.innerHTML = Object.values(monthlyData).map(data => {
        const balance = data.income - data.expense;
        const balanceClass = balance >= 0 ? 'text-green-600' : 'text-red-600';
        
        return `
          <div class="bg-gray-50 rounded-xl p-4">
            <h4 class="font-bold text-gray-800 mb-2">${data.month}</h4>
            <div class="space-y-1 text-sm">
              <div class="flex justify-between">
                <span class="text-gray-600">‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö:</span>
                <span class="text-green-600">${formatCurrency(data.income)}</span>
              </div>
              <div class="flex justify-between">
                <span class="text-gray-600">‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢:</span>
                <span class="text-red-600">${formatCurrency(data.expense)}</span>
              </div>
              <div class="flex justify-between font-bold border-t pt-1">
                <span class="text-gray-800">‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠:</span>
                <span class="${balanceClass}">${formatCurrency(balance)}</span>
              </div>
            </div>
          </div>
        `;
      }).join('');
    }

    // Show message
    function showMessage(text, type = 'success') {
      message.textContent = text;
      message.className = `mt-4 p-4 rounded-xl font-medium animate-fadeIn ${
        type === 'success' ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700'
      }`;
      message.classList.remove('hidden');
      setTimeout(() => message.classList.add('hidden'), 3000);
    }

    // Add transaction
    async function addTransaction(type, amount, note, category, date) {
      try {
        const newRef = push(ref(database, 'expenses'));
        await set(newRef, {
          type,
          amount: parseFloat(amount),
          note: note || category,
          category: category || '‡∏≠‡∏∑‡πà‡∏ô‡πÜ',
          date,
          timestamp: Date.now()
        });
        return true;
      } catch (error) {
        console.error('Error saving data:', error);
        return false;
      }
    }

    // Setup event listeners
    function setupEventListeners() {
      // Form submission
      form.addEventListener('submit', async (e) => {
        e.preventDefault();

        const type = document.getElementById('type').value;
        const amount = document.getElementById('amount').value;
        const note = document.getElementById('note').value;
        const category = document.getElementById('category').value;
        const date = document.getElementById('date').value;

        if (parseFloat(amount) <= 0) {
          showMessage('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ 0', 'error');
          return;
        }

        const success = await addTransaction(type, amount, note, category, date);
        
        if (success) {
          form.reset();
          document.getElementById('date').valueAsDate = new Date();
          showMessage('‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!', 'success');
        } else {
          showMessage('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•', 'error');
        }
      });

      // Recurring form submission
      document.getElementById('recurringForm').addEventListener('submit', async (e) => {
        e.preventDefault();

        const type = document.getElementById('recurringType').value;
        const amount = document.getElementById('recurringAmount').value;
        const note = document.getElementById('recurringNote').value;
        const category = document.getElementById('recurringCategory').value;
        const day = document.getElementById('recurringDay').value;

        try {
          const newRef = push(ref(database, 'recurring'));
          await set(newRef, {
            type,
            amount: parseFloat(amount),
            note: note || category,
            category,
            day: parseInt(day),
            timestamp: Date.now()
          });

          document.getElementById('recurringForm').reset();
          showMessage('‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!', 'success');
        } catch (error) {
          showMessage('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•', 'error');
        }
      });

      // Type change handlers
      document.getElementById('type').addEventListener('change', updateCategorySelectors);
      document.getElementById('recurringType').addEventListener('change', updateCategorySelectors);
      document.getElementById('editType').addEventListener('change', updateCategorySelectors);

      // Date filter handlers
      document.getElementById('monthSelector').addEventListener('change', filterTransactionsByDate);
      document.getElementById('yearSelector').addEventListener('change', filterTransactionsByDate);
      document.getElementById('searchInput').addEventListener('input', filterTransactionsByDate);
      document.getElementById('yearSummarySelector').addEventListener('change', updateYearSummary);

      // Category management
      document.getElementById('addIncomeCategory').addEventListener('click', () => addCategory('income'));
      document.getElementById('addExpenseCategory').addEventListener('click', () => addCategory('expense'));

      // Data management
      document.getElementById('exportData').addEventListener('click', exportData);
      document.getElementById('backupData').addEventListener('click', backupData);
      document.getElementById('resetCategories').addEventListener('click', resetCategories);
      document.getElementById('clearAllData').addEventListener('click', clearAllData);

      // Edit modal
      document.getElementById('closeEdit').addEventListener('click', closeEditModal);
      document.getElementById('editForm').addEventListener('submit', saveEdit);
    }

    // Global functions for onclick handlers
    window.editTransaction = function(key) {
      const transaction = allTransactions.find(t => t.key === key);
      if (transaction) {
        document.getElementById('editId').value = key;
        document.getElementById('editType').value = transaction.data.type;
        document.getElementById('editAmount').value = transaction.data.amount;
        document.getElementById('editNote').value = transaction.data.note;
        document.getElementById('editDate').value = transaction.data.date;
        
        updateCategorySelectors();
        document.getElementById('editCategory').value = transaction.data.category;
        
        document.getElementById('editModal').classList.remove('hidden');
        document.getElementById('editModal').classList.add('flex');
      }
    };

    window.deleteTransaction = async function(key) {
      if (confirm('‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
        try {
          await remove(ref(database, `expenses/${key}`));
          showMessage('‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!', 'success');
        } catch (error) {
          showMessage('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£', 'error');
        }
      }
    };

    window.processRecurring = async function(key) {
      const recurring = recurringTransactions.find(r => r.key === key);
      if (recurring) {
        const today = new Date();
        const currentMonth = String(today.getMonth() + 1).padStart(2, '0');
        const currentYear = today.getFullYear();
        const day = String(recurring.data.day).padStart(2, '0');
        const date = `${currentYear}-${currentMonth}-${day}`;
        
        const success = await addTransaction(
          recurring.data.type,
          recurring.data.amount,
          recurring.data.note,
          recurring.data.category,
          date
        );
        
        if (success) {
          showMessage('‚úÖ ‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!', 'success');
        }
      }
    };

    window.deleteRecurring = async function(key) {
      if (confirm('‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ô‡∏µ‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
        try {
          await remove(ref(database, `recurring/${key}`));
          showMessage('‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!', 'success');
        } catch (error) {
          showMessage('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£', 'error');
        }
      }
    };

    window.deleteCategory = async function(type, id) {
      if (confirm('‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏ô‡∏µ‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
        try {
          await remove(ref(database, `categories/${type}/${id}`));
          showMessage('‡∏•‡∏ö‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!', 'success');
        } catch (error) {
          showMessage('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà', 'error');
        }
      }
    };

    // Add category
    async function addCategory(type) {
      const nameInput = document.getElementById(`new${type.charAt(0).toUpperCase() + type.slice(1)}Category`);
      const iconInput = document.getElementById(`new${type.charAt(0).toUpperCase() + type.slice(1)}CategoryIcon`);
      
      const name = nameInput.value.trim();
      const icon = iconInput.value.trim() || (type === 'income' ? 'üíµ' : 'üí∏');
      
      if (!name) {
        showMessage('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà', 'error');
        return;
      }
      
      try {
        const newRef = push(ref(database, `categories/${type}`));
        await set(newRef, { name, icon });
        
        nameInput.value = '';
        iconInput.value = '';
        showMessage('‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!', 'success');
      } catch (error) {
        showMessage('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà', 'error');
      }
    }

    // Close edit modal
    function closeEditModal() {
      document.getElementById('editModal').classList.add('hidden');
      document.getElementById('editModal').classList.remove('flex');
    }

    // Save edit
    async function saveEdit(e) {
      e.preventDefault();
      
      const key = document.getElementById('editId').value;
      const type = document.getElementById('editType').value;
      const amount = parseFloat(document.getElementById('editAmount').value);
      const note = document.getElementById('editNote').value;
      const category = document.getElementById('editCategory').value;
      const date = document.getElementById('editDate').value;
      
      try {
        await update(ref(database, `expenses/${key}`), {
          type,
          amount,
          note: note || category,
          category,
          date,
          timestamp: Date.now()
        });
        
        closeEditModal();
        showMessage('‚úÖ ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!', 'success');
      } catch (error) {
        showMessage('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£', 'error');
      }
    }

    // Export data
    function exportData() {
      const csvContent = "data:text/csv;charset=utf-8," + 
        "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà,‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó,‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà,‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô,‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏\n" +
        allTransactions.map(({ data }) => 
          `${data.date},${data.type},${data.category},${data.amount},"${data.note}"`
        ).join('\n');
      
      const encodedUri = encodeURI(csvContent);
      const link = document.createElement('a');
      link.setAttribute('href', encodedUri);
      link.setAttribute('download', `‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢_${new Date().toISOString().split('T')[0]}.csv`);
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      
      showMessage('‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!', 'success');
    }

    // Backup data
    function backupData() {
      const backupData = {
        transactions: allTransactions,
        recurring: recurringTransactions,
        categories: { income: incomeCategories, expense: expenseCategories }
      };
      
      const dataStr = JSON.stringify(backupData, null, 2);
      const blob = new Blob([dataStr], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      const link = document.createElement('a');
      link.href = url;
      link.download = `backup_${new Date().toISOString().split('T')[0]}.json`;
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      URL.revokeObjectURL(url);
      
      showMessage('‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!', 'success');
    }

    // Reset categories
    async function resetCategories() {
      if (confirm('‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
        try {
          await set(ref(database, 'categories/income'), null);
          await set(ref(database, 'categories/expense'), null);
          
          // Add default categories
          defaultIncomeCategories.forEach((cat, index) => {
            set(ref(database, `categories/income/${index}`), cat);
          });
          
          defaultExpenseCategories.forEach((cat, index) => {
            set(ref(database, `categories/expense/${index}`), cat);
          });
          
          showMessage('‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!', 'success');
        } catch (error) {
          showMessage('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà', 'error');
        }
      }
    }

    // Clear all data
    async function clearAllData() {
      if (confirm('‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà? ‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏î‡πâ!')) {
        if (confirm('‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà? ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏•‡∏ö‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ñ‡∏≤‡∏ß‡∏£!')) {
          try {
            await set(ref(database, 'expenses'), null);
            await set(ref(database, 'recurring'), null);
            showMessage('‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!', 'success');
          } catch (error) {
            showMessage('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•', 'error');
          }
        }
      }
    }

    // Initialize the app
    init();
  </script>
  <script>
   (function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'96bbfc52016b10e2',t:'MTc1NDYyNDM1Ni4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();
  </script>
 </body>
</html>
